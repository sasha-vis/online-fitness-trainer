name: Check Branch Naming

on:
    pull_request:
        branches: [develop, main]
        types: [opened, synchronize]

jobs:
    check-branch-name:
        runs-on: ubuntu-latest
        steps:
            - name: Validate branch name
              run: |
                  BRANCH_NAME="${{ github.head_ref }}"
                  TARGET_BRANCH="${{ github.base_ref }}"
                  echo "üîç Checking PR: $BRANCH_NAME ‚Üí $TARGET_BRANCH"

                  # –î–ª—è PR –≤ main - —Ç–æ–ª—å–∫–æ release
                  if [[ "$TARGET_BRANCH" == "main" ]]; then
                    if [[ ! "$BRANCH_NAME" =~ ^release/[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
                      echo "::error ::Invalid branch name for main: $BRANCH_NAME"
                      echo "‚úÖ Use: release/1.2.0"
                      exit 1
                    fi
                  fi

                  # –î–ª—è PR –≤ develop - —Ç–æ–ª—å–∫–æ feature/fix –∏ –æ–±—Ä–∞—Ç–Ω—ã–π –º–µ—Ä–∂ —Ä–µ–ª–∏–∑–∞
                  if [[ "$TARGET_BRANCH" == "develop" ]]; then

                    # Release branches (—Ñ–æ—Ä–º–∞—Ç: release/1.2.3)
                    if [[ "$BRANCH_NAME" =~ ^release/[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
                      echo "‚úÖ Release branch to develop: $BRANCH_NAME"
                    
                    # Feature/fix branches (—Ñ–æ—Ä–º–∞—Ç: (feture|fix)/123-title)
                    elif [[ "$BRANCH_NAME" =~ ^(feature|fix)/[0-9]+-[a-z0-9-]+$ ]]; then
                      echo "‚úÖ Feature/fix branch to develop: $BRANCH_NAME"
                    
                    else
                      echo "::error ::Invalid branch name for develop: $BRANCH_NAME"
                      echo "‚úÖ Use: feature/123-title, fix/456-title, or release/1.2.3"
                      exit 1
                    fi
                  fi

                  

                  echo "‚úÖ Branch name is valid: $BRANCH_NAME"
