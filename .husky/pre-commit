#!/bin/bash

# Получаем текущую ветку
CURRENT_BRANCH=$(git branch --show-current)

# Игнорируем защищённые ветки
if [[ "$CURRENT_BRANCH" == "main" || "$CURRENT_BRANCH" == "develop" || "$CURRENT_BRANCH" =~ ^release/ ]]; then
  echo "⚠️  Вы в защищённой ветке $CURRENT_BRANCH !"
  exit 1
fi

# Проверяем формат ветки (только feature/ и fix/)
if ! echo "$CURRENT_BRANCH" | grep -qE "^(feature|fix)/[0-9]+-[a-z0-9-]+$"; then
  echo "❌ Неправильное название ветки: $CURRENT_BRANCH"
  echo "✅ Правильный формат: feature/номер-задачи-название или fix/номер-задачи-название"
  echo "   Примеры:"
  echo "   - feature/23-add-login-form"
  echo "   - fix/45-correct-calculation"
  exit 1
fi
